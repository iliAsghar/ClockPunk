<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>24-Hour Clock</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #232526 0%, #000000 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .clock-container {
            width: 90%;
            max-width: 1000px;
            position: relative;
        }

        .clock-title {
            text-align: center;
            color: #e0e0e0;
            font-size: 28px;
            margin-bottom: 50px;
            position: relative;
        }

        .clock-line {
            height: 4px;
            background: white;
            position: relative;
            border-radius: 2px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .hour-mark {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 2px;
            height: 14px;
            background: white;
        }

        .hour-label {
            position: absolute;
            top: -30px;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 4px rgba(0, 0, 0, 0.5);
        }

        .friend-container {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            /* Add padding to create a large, invisible hover area */
            padding: 30px 10px;
        }

        .timezone-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 3px;
            height: 20px;
            transform: translate(-50%, -50%);
            border-radius: 2px; /* Keep this for rounded corners */
        }

        .timezone-name {
            position: absolute;
            top: 75%; /* Position from the top of the container */
            left: 50%; /* Ensure horizontal centering */
            transform: translateX(-50%);
            font-size: 14px;
            color: white;
            text-shadow: 0 0 4px rgba(0, 0, 0, 0.5);
            white-space: nowrap;
        }

        .tooltip {
            visibility: hidden;
            position: absolute;
            bottom: 150%; /* Position above the indicator */
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            text-align: center;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 16px;
            white-space: nowrap;
            z-index: 1;
        }

        .friend-container:hover .tooltip {
            visibility: visible;
        }

        .timezone-indicator {
            animation: gentle-glow 2s infinite ease-in-out;
        }

        @keyframes gentle-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <div class="clock-container">
        <h1 class="clock-title">üï∞Ô∏è World Clock</h1>
        <div class="clock-line" id="clockLine"></div>
    </div>

    <script src="times/timezones.js"></script>
    <script>
        const clockLine = document.getElementById('clockLine');
        const lineWidth = clockLine.offsetWidth;

        // Create hour marks and labels
        for (let hour = 0; hour <= 24; hour++) {
            const percentage = (hour / 24) * 100;
            const position = (hour / 24) * lineWidth;

            // Create hour mark
            const mark = document.createElement('div');
            mark.className = 'hour-mark';
            mark.style.left = percentage + '%';
            clockLine.appendChild(mark);

            // Create hour label
            const label = document.createElement('div');
            label.className = 'hour-label';
            label.textContent = hour;
            label.style.left = percentage + '%';
            clockLine.appendChild(label);
        }

        // Create indicators for each friend
        friendsTimezones.forEach(friend => {
            // Create the main container for this friend
            const friendContainer = document.createElement('div');
            friendContainer.className = 'friend-container';
            friendContainer.id = `container-${friend.name}`; // Unique ID for updating

            // Create the indicator line
            const indicator = document.createElement('div');
            indicator.className = 'timezone-indicator';
            indicator.style.background = friend.color;
            indicator.style.boxShadow = `0 0 10px ${friend.color}`;
            
            // Create the name label
            const nameLabel = document.createElement('div');
            nameLabel.className = 'timezone-name';
            nameLabel.textContent = friend.name;
            
            // Create the tooltip
            const tooltip = document.createElement('span');
            tooltip.className = 'tooltip';
            indicator.appendChild(tooltip);

            // Append elements to their containers
            friendContainer.appendChild(indicator);
            friendContainer.appendChild(nameLabel);
            clockLine.appendChild(friendContainer);
        });

        function updateClocks() {
            friendsTimezones.forEach(friend => {
                const container = document.getElementById(`container-${friend.name}`);
                const tooltip = container.querySelector('.tooltip');
                if (!container) return;

                // Get current time in the specified timezone
                const gmtString = friend.timezone;
                const offsetString = gmtString.replace(/GMT/i, '').trim();

                // Parse hours and minutes from formats like "+5:30" or "-8"
                const parts = offsetString.split(':');
                const offsetHours = parseInt(parts[0], 10);
                const offsetMinutes = parts.length > 1 ? parseInt(parts[1], 10) : 0;

                if (isNaN(offsetHours) || isNaN(offsetMinutes)) {
                    console.error(`Invalid timezone format for ${friend.name}: ${gmtString}`);
                    tooltip.textContent = 'Error';
                    return; // Skip to the next friend
                }

                // Get the sign of the offset to apply it correctly to the minutes
                const sign = Math.sign(offsetHours) || 1;

                // Calculate the time based on UTC and the offset
                const now = new Date();
                const totalOffsetInMinutes = (offsetHours * 60) + (offsetMinutes * sign);
                now.setUTCMinutes(now.getUTCMinutes() + totalOffsetInMinutes);

                // Extract the new local time components
                const hours = now.getUTCHours();
                const minutes = now.getUTCMinutes();
                const seconds = now.getUTCSeconds();

                // Update tooltip text
                const timeString = 
                    String(hours).padStart(2, '0') + ':' + 
                    String(minutes).padStart(2, '0') + ':' +
                    String(seconds).padStart(2, '0');
                tooltip.textContent = timeString;

                // Convert current time to a percentage of the day
                const totalSeconds = hours * 3600 + minutes * 60 + seconds;
                const totalSecondsInDay = 24 * 3600;
                const positionPercentage = (totalSeconds / totalSecondsInDay) * 100;

                // Update indicator position
                container.style.left = positionPercentage + '%';
            });
        }

        // Initial update
        updateClocks();

        // Update every 100ms for smooth movement
        setInterval(updateClocks, 100);
    </script>
</body>
</html>
